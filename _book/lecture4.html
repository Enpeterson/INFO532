<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Basic GIS Operations | test</title>
  <meta name="description" content="This book covers topics discussed in INFO 532: Advanced Geographic Information Systems." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Basic GIS Operations | test" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book covers topics discussed in INFO 532: Advanced Geographic Information Systems." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Basic GIS Operations | test" />
  
  <meta name="twitter:description" content="This book covers topics discussed in INFO 532: Advanced Geographic Information Systems." />
  

<meta name="author" content="Emily Peterson &amp; Alex Edwards" />


<meta name="date" content="2023-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lecture3.html"/>
<link rel="next" href="introduction-to-raster-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>INFO 532: Advanced Geographic Information Systems Fall 2023</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-class"><i class="fa fa-check"></i>About the class</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#grading"><i class="fa fa-check"></i>Grading</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#labs"><i class="fa fa-check"></i>Labs</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-do-i-get-help"><i class="fa fa-check"></i>How do I get help?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources-for-students"><i class="fa fa-check"></i>Resources for students</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#diversity-and-inclusion-statement"><i class="fa fa-check"></i>Diversity and Inclusion Statement</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-this-notebook"><i class="fa fa-check"></i>Using this notebook</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-gis.html"><a href="introduction-to-gis.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-gis.html"><a href="introduction-to-gis.html#what-is-gis"><i class="fa fa-check"></i><b>1.1</b> What is GIS?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-gis.html"><a href="introduction-to-gis.html#how-is-gis-used"><i class="fa fa-check"></i><b>1.2</b> How is GIS used?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-gis.html"><a href="introduction-to-gis.html#feature-representation"><i class="fa fa-check"></i><b>1.3</b> Feature Representation</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-gis.html"><a href="introduction-to-gis.html#vector"><i class="fa fa-check"></i><b>1.3.1</b> Vector</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction-to-gis.html"><a href="introduction-to-gis.html#raster"><i class="fa fa-check"></i><b>1.3.2</b> Raster</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#panes-in-rstudio"><i class="fa fa-check"></i><b>2.1</b> Panes in RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#your-first-r-script"><i class="fa fa-check"></i><b>2.2</b> Your first R script</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#data-types-in-r"><i class="fa fa-check"></i><b>2.3</b> Data Types in R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#vectors"><i class="fa fa-check"></i><b>2.3.1</b> Vectors</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#matrices-and-data-frames"><i class="fa fa-check"></i><b>2.3.2</b> Matrices and Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#functions-and-packages-in-r"><i class="fa fa-check"></i><b>2.4</b> Functions and Packages in R</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#writing-reproducible-code"><i class="fa fa-check"></i><b>2.5</b> Writing Reproducible Code</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#creating-a-r-markdown-file"><i class="fa fa-check"></i><b>2.6</b> Creating a R Markdown file</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="intro.html"><a href="intro.html#the-yaml-header"><i class="fa fa-check"></i><b>2.6.1</b> The YAML Header</a></li>
<li class="chapter" data-level="2.6.2" data-path="intro.html"><a href="intro.html#markdown-syntax"><i class="fa fa-check"></i><b>2.6.2</b> Markdown syntax</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lecture3.html"><a href="lecture3.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lecture3.html"><a href="lecture3.html#introduction-to-dplyr"><i class="fa fa-check"></i><b>3.1</b> Introduction to DPLYR</a></li>
<li class="chapter" data-level="3.2" data-path="lecture3.html"><a href="lecture3.html#introduction-to-sf"><i class="fa fa-check"></i><b>3.2</b> Introduction to <em>sf</em></a></li>
<li class="chapter" data-level="3.3" data-path="lecture3.html"><a href="lecture3.html#an-introduction-to-tmap"><i class="fa fa-check"></i><b>3.3</b> An Introduction to TMAP</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="lecture3.html"><a href="lecture3.html#layer-1"><i class="fa fa-check"></i><b>3.3.1</b> Layer 1</a></li>
<li class="chapter" data-level="3.3.2" data-path="lecture3.html"><a href="lecture3.html#layer-2"><i class="fa fa-check"></i><b>3.3.2</b> Layer 2</a></li>
<li class="chapter" data-level="3.3.3" data-path="lecture3.html"><a href="lecture3.html#layer-3"><i class="fa fa-check"></i><b>3.3.3</b> Layer 3</a></li>
<li class="chapter" data-level="3.3.4" data-path="lecture3.html"><a href="lecture3.html#layer-4"><i class="fa fa-check"></i><b>3.3.4</b> Layer 4</a></li>
<li class="chapter" data-level="3.3.5" data-path="lecture3.html"><a href="lecture3.html#adding-context"><i class="fa fa-check"></i><b>3.3.5</b> Adding Context</a></li>
<li class="chapter" data-level="3.3.6" data-path="lecture3.html"><a href="lecture3.html#saving-your-map"><i class="fa fa-check"></i><b>3.3.6</b> Saving Your Map</a></li>
<li class="chapter" data-level="3.3.7" data-path="lecture3.html"><a href="lecture3.html#interactive-mapping"><i class="fa fa-check"></i><b>3.3.7</b> Interactive Mapping</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="lecture3.html"><a href="lecture3.html#introduction-to-tidycensus"><i class="fa fa-check"></i><b>3.4</b> Introduction to TIDYCENSUS</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="lecture3.html"><a href="lecture3.html#geography-in-tidycensus"><i class="fa fa-check"></i><b>3.4.1</b> Geography in Tidycensus</a></li>
<li class="chapter" data-level="3.4.2" data-path="lecture3.html"><a href="lecture3.html#searching-for-variables-in-tidycensus"><i class="fa fa-check"></i><b>3.4.2</b> Searching for variables in Tidycensus</a></li>
<li class="chapter" data-level="3.4.3" data-path="lecture3.html"><a href="lecture3.html#extracting-the-data-in-tidycensus"><i class="fa fa-check"></i><b>3.4.3</b> Extracting the data in Tidycensus</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="lecture3.html"><a href="lecture3.html#introduction-to-shapefile-and-tigris"><i class="fa fa-check"></i><b>3.5</b> Introduction to Shapefile and Tigris</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lecture4.html"><a href="lecture4.html"><i class="fa fa-check"></i><b>4</b> Basic GIS Operations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lecture4.html"><a href="lecture4.html#new-haven-data"><i class="fa fa-check"></i><b>4.1</b> New Haven Data</a></li>
<li class="chapter" data-level="4.2" data-path="lecture4.html"><a href="lecture4.html#sec1"><i class="fa fa-check"></i><b>4.2</b> Spatial Clip and Intersection Operations</a></li>
<li class="chapter" data-level="4.3" data-path="lecture4.html"><a href="lecture4.html#sec2"><i class="fa fa-check"></i><b>4.3</b> Buffers and Features</a></li>
<li class="chapter" data-level="4.4" data-path="lecture4.html"><a href="lecture4.html#sec3"><i class="fa fa-check"></i><b>4.4</b> Merging Spatial Features</a></li>
<li class="chapter" data-level="4.5" data-path="lecture4.html"><a href="lecture4.html#point-in-polygon-and-area-calculations"><i class="fa fa-check"></i><b>4.5</b> Point-In-Polygon and Area Calculations</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="lecture4.html"><a href="lecture4.html#point-in-polygon"><i class="fa fa-check"></i><b>4.5.1</b> Point-In-Polygon</a></li>
<li class="chapter" data-level="4.5.2" data-path="lecture4.html"><a href="lecture4.html#area-calculations"><i class="fa fa-check"></i><b>4.5.2</b> Area Calculations</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="lecture4.html"><a href="lecture4.html#creating-distance-attributes"><i class="fa fa-check"></i><b>4.6</b> Creating Distance Attributes</a></li>
<li class="chapter" data-level="4.7" data-path="lecture4.html"><a href="lecture4.html#distanceaccessibility-analysis"><i class="fa fa-check"></i><b>4.7</b> Distance/Accessibility Analysis</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html"><i class="fa fa-check"></i><b>5</b> Introduction to Raster in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#what-are-we-doing-today"><i class="fa fa-check"></i><b>5.1</b> What are we doing today:</a></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#learning-objectives"><i class="fa fa-check"></i><b>5.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#things-youll-need-to-complete-this-tutorial"><i class="fa fa-check"></i><b>5.3</b> Things You’ll Need To Complete This Tutorial</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#install-r-packages"><i class="fa fa-check"></i><b>5.3.1</b> Install R Packages</a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#download-data"><i class="fa fa-check"></i><b>5.3.2</b> Download Data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#about-raster-data"><i class="fa fa-check"></i><b>5.4</b> About Raster Data</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#raster-data-in-r"><i class="fa fa-check"></i><b>5.5</b> Raster Data in R</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#open-a-raster-in-r"><i class="fa fa-check"></i><b>5.6</b> Open a Raster in R</a></li>
<li class="chapter" data-level="5.7" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#types-of-data-stored-in-raster-format"><i class="fa fa-check"></i><b>5.7</b> Types of Data Stored in Raster Format</a></li>
<li class="chapter" data-level="5.8" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#what-is-a-geotiff"><i class="fa fa-check"></i><b>5.8</b> What is a GeoTIFF??</a></li>
<li class="chapter" data-level="5.9" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#coordinate-reference-system"><i class="fa fa-check"></i><b>5.9</b> Coordinate Reference System</a></li>
<li class="chapter" data-level="5.10" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#what-makes-spatial-data-line-up-on-a-map"><i class="fa fa-check"></i><b>5.10</b> What Makes Spatial Data Line Up On A Map?</a></li>
<li class="chapter" data-level="5.11" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#view-raster-coordinate-reference-system-crs-in-r"><i class="fa fa-check"></i><b>5.11</b> View Raster Coordinate Reference System (CRS) in R</a></li>
<li class="chapter" data-level="5.12" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#extent"><i class="fa fa-check"></i><b>5.12</b> Extent</a></li>
<li class="chapter" data-level="5.13" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#resolution"><i class="fa fa-check"></i><b>5.13</b> Resolution</a></li>
<li class="chapter" data-level="5.14" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#calculate-raster-min-and-max-values"><i class="fa fa-check"></i><b>5.14</b> Calculate Raster Min and Max Values</a></li>
<li class="chapter" data-level="5.15" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#nodata-values-in-rasters"><i class="fa fa-check"></i><b>5.15</b> NoData Values in Rasters</a></li>
<li class="chapter" data-level="5.16" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#bad-data-values-in-rasters"><i class="fa fa-check"></i><b>5.16</b> Bad Data Values in Rasters</a>
<ul>
<li class="chapter" data-level="5.16.1" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#find-bad-data-values"><i class="fa fa-check"></i><b>5.16.1</b> Find Bad Data Values</a></li>
</ul></li>
<li class="chapter" data-level="5.17" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#create-a-histogram-of-raster-values"><i class="fa fa-check"></i><b>5.17</b> Create A Histogram of Raster Values</a></li>
<li class="chapter" data-level="5.18" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#raster-bands"><i class="fa fa-check"></i><b>5.18</b> Raster Bands</a></li>
<li class="chapter" data-level="5.19" data-path="introduction-to-raster-in-r.html"><a href="introduction-to-raster-in-r.html#view-raster-file-attributes"><i class="fa fa-check"></i><b>5.19</b> View Raster File Attributes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html"><i class="fa fa-check"></i><b>6</b> Introduction to Kernel Density Estimation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#point-patterns"><i class="fa fa-check"></i><b>6.1</b> Point Patterns</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#surfaces-showing-where-events-are-more-likely-to-happen"><i class="fa fa-check"></i><b>6.2</b> Surfaces showing where events are more likely to happen</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#kernel-density-estimation-kde"><i class="fa fa-check"></i><b>6.3</b> Kernel Density Estimation (KDE)</a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#section"><i class="fa fa-check"></i><b>6.4</b> </a></li>
<li class="chapter" data-level="6.5" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#how-to-choose-bandwidth"><i class="fa fa-check"></i><b>6.5</b> How to choose bandwidth</a></li>
<li class="chapter" data-level="6.6" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#lets-look-again-at-the-breach-data"><i class="fa fa-check"></i><b>6.6</b> Let’s look again at the Breach data…</a></li>
<li class="chapter" data-level="6.7" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#how-to-calculate-kdes"><i class="fa fa-check"></i><b>6.7</b> How to calculate KDEs</a></li>
<li class="chapter" data-level="6.8" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#using-kde-for-comparisons"><i class="fa fa-check"></i><b>6.8</b> Using KDE for comparisons</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="introduction-to-kernel-density-estimation.html"><a href="introduction-to-kernel-density-estimation.html#operations-for-comparing-kde"><i class="fa fa-check"></i><b>6.8.1</b> Operations for comparing KDE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="6.9" data-path="references.html"><a href="references.html#r-markdown"><i class="fa fa-check"></i><b>6.9</b> R Markdown</a></li>
<li class="chapter" data-level="6.10" data-path="references.html"><a href="references.html#including-plots"><i class="fa fa-check"></i><b>6.10</b> Including Plots</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">test</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lecture4" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Basic GIS Operations<a href="lecture4.html#lecture4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="rmdtip">
<p><strong>Thought box</strong>
In GIS and spatial analysis, we are often interested in finding out how the information contained in one spatial dataset relates to that contained in another.</p>
<ul>
<li>Big Picture Question: Our public health goal is to investigate counts and/or rates of a given health indicator or event within the context of spatial attributes.</li>
<li>What are some of the questions we may be interested in investigating?
<ul>
<li>Trends of rates/counts in specific locations or areas?</li>
<li>Relationship between outcomes and proximity to thinks in the physical environment.</li>
<li>Relationships between outcomes and socio-demographic risk factors.</li>
<li>How many X are there in different locations of Y?</li>
<li>How many of X are found within a certain distance of Y?</li>
</ul></li>
<li>Can you think of any public health or other research applications where we may want to answer the questions above?</li>
</ul>
</div>
<p>In this chapter we will use examples to illustrate a number of fundamental and commonly applied spatial operations on spatial datasets. Essentially, the operations illustrate different methods for extracting information from one spatial dataset based on the spatial extent of another, referred to overlay operations. The sections below describe the following operations:</p>
<ol style="list-style-type: decimal">
<li>Intersection and clipping one dataset to the extent of another, Section <a href="lecture4.html#sec1">4.2</a></li>
<li>Creating buffers around features <a href="lecture4.html#sec2">4.3</a></li>
<li>Merging the features in a spatial dataset <a href="lecture4.html#sec3">4.4</a></li>
<li>Point-in-polygon and area calculations</li>
<li>Creating distance attributes</li>
<li>Combining spatial data and attributes</li>
<li>Converting between raster and vector</li>
</ol>
<div id="new-haven-data" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> New Haven Data<a href="lecture4.html#new-haven-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In lectures, we will illustrate analysis using data from the [New Haven CT crime web site] containing point sources of some crimes, plus roads, railways, and census block spatial data frames. The New Haven data include:</p>
<ul>
<li>blocks: A polygon data set with demographic breakdowns by census blocks within New Haven.</li>
<li>breach: A point data set with locations of breaches of the peace.</li>
<li>roads: A lines data set with road spatial features in New Haven.</li>
<li>places: A point data set with locations of major landmarks in New Haven.</li>
<li>famdisp: A point data set with locations of family disputes.</li>
</ul>
<p>The plot below shows an example of the New Haven data, in which we plot population by census block (orange polygons), the breaches of peace (red), landmarks (blue), and roads (green.)</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="sec1" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Spatial Clip and Intersection Operations<a href="lecture4.html#sec1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="rmdnote">
<p><strong>What is clipping?</strong></p>
<p>A geographic clip cuts out an input layer to a defined spatial feature boundary. Like a cookie-cutter to a spatial area. The clip and intersect tool achieve the same results. The main difference is that an intersection preserves attributes from both tables.</p>
</div>
<p>Consider the situation where the aim is to analyze the incidence of a particular area: we do not want to analyze ALL the data but only those records that describe events in a given study area. In the code below we call in the New Haven data and create <span class="math inline">\(sf\)</span> data frames for the blocks and breaches data. We then subset to areas in central New haven and subsets the census block data to only include these selected areas.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="lecture4.html#cb1-1" tabindex="-1"></a><span class="co">#Call in the libraries</span></span>
<span id="cb1-2"><a href="lecture4.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="lecture4.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(GISTools)</span>
<span id="cb1-4"><a href="lecture4.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1-5"><a href="lecture4.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-6"><a href="lecture4.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="lecture4.html#cb1-7" tabindex="-1"></a><span class="co">#read in New Haven data and...</span></span>
<span id="cb1-8"><a href="lecture4.html#cb1-8" tabindex="-1"></a><span class="co">#transform the census block and breach data to sf objects</span></span>
<span id="cb1-9"><a href="lecture4.html#cb1-9" tabindex="-1"></a><span class="fu">data</span>(newhaven)</span>
<span id="cb1-10"><a href="lecture4.html#cb1-10" tabindex="-1"></a>blocks_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(blocks)</span>
<span id="cb1-11"><a href="lecture4.html#cb1-11" tabindex="-1"></a>breach_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(breach)</span>
<span id="cb1-12"><a href="lecture4.html#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="lecture4.html#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="lecture4.html#cb1-14" tabindex="-1"></a><span class="co"># Set the indices to subset</span></span>
<span id="cb1-15"><a href="lecture4.html#cb1-15" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">46</span><span class="sc">:</span><span class="dv">47</span>,<span class="dv">51</span>, <span class="dv">53</span>, <span class="dv">57</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1-16"><a href="lecture4.html#cb1-16" tabindex="-1"></a><span class="co"># Create a new data set blocks_sf2 that includes only the selected areas</span></span>
<span id="cb1-17"><a href="lecture4.html#cb1-17" tabindex="-1"></a>blocks_sf2 <span class="ot">&lt;-</span> blocks_sf[indices,]</span>
<span id="cb1-18"><a href="lecture4.html#cb1-18" tabindex="-1"></a></span>
<span id="cb1-19"><a href="lecture4.html#cb1-19" tabindex="-1"></a><span class="fu">tm_shape</span>(blocks_sf2) <span class="sc">+</span></span>
<span id="cb1-20"><a href="lecture4.html#cb1-20" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-21"><a href="lecture4.html#cb1-21" tabindex="-1"></a>  <span class="fu">tm_shape</span>(breach_sf) <span class="sc">+</span></span>
<span id="cb1-22"><a href="lecture4.html#cb1-22" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Is this what we want? <strong>No</strong>. We want to clip the breach data to only include points within our selected areas. There are a number of ways to clip spatial data. The simplest way is to use the spatial boundaries of one as an index to subset another.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="lecture4.html#cb2-1" tabindex="-1"></a><span class="co">#Clip the breach data to align with the blocks2 data.</span></span>
<span id="cb2-2"><a href="lecture4.html#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="lecture4.html#cb2-3" tabindex="-1"></a>breach_clip_sf <span class="ot">&lt;-</span> breach_sf[blocks_sf2,]</span></code></pre></div>
<p>However, such clip (or crop) operations simply subset data based on spatial boundaries. There may be applications where you wish to combine attributes of different data sets based on <em>spatial intersection</em>. The <span class="math inline">\(st\_intersection()\)</span> function allows us to do this, shown below. Here we want to combine the breach and census block data from New Haven. You can see when we combine data sets we obtain a point data frame with census block attributes for each location.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="lecture4.html#cb3-1" tabindex="-1"></a><span class="co">#Intersect breach and block data</span></span>
<span id="cb3-2"><a href="lecture4.html#cb3-2" tabindex="-1"></a>br_bl_sf <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(blocks_sf2, breach_sf)</span>
<span id="cb3-3"><a href="lecture4.html#cb3-3" tabindex="-1"></a><span class="fu">head</span>(br_bl_sf)</span></code></pre></div>
<pre><code>Simple feature collection with 6 features and 28 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 546241.4 ymin: 169623.6 xmax: 558373.1 ymax: 177376.3
Projected CRS: SOURCECRS
   NEWH075H_ NEWH075H_I HSE_UNITS OCCUPIED VACANT  P_VACANT P_OWNEROCC
98       100         25       375      311     64 17.066667   4.266667
93        95        111         0        0      0  0.000000   0.000000
99       101         27       207      168     39 18.840580  11.111111
83        85        123       461      389     72 15.618221  29.067245
52        54         87       347      328     19  5.475504   2.305476
95        97         51       302      270     32 10.596026  36.092715
   P_RENTROCC NEWH075P_ NEWH075P_I POP1990  P_MALES P_FEMALES   P_WHITE
98   78.66667       100        528     499 56.91383  43.08617 73.547094
93    0.00000        95        523       0  0.00000   0.00000  0.000000
99   70.04831       101        531     782 53.45269  46.54731 30.306905
83   55.31453        85        511    1277 48.08144  51.91856 48.238058
52   92.21902        54        471     967 42.50259  57.49741  3.102378
95   53.31126        97        525     823 49.33171  50.66829 50.911300
    P_BLACK P_AMERI_ES P_ASIAN_PI   P_OTHER  P_UNDER5    P_5_13  P_14_17
98 14.82966   1.002004   9.018036  1.603206  0.801603  2.605210 0.400802
93  0.00000   0.000000   0.000000  0.000000  0.000000  0.000000 0.000000
99 45.26854   0.255754   0.511509 23.657289  9.335038 15.089514 5.626598
83 23.49256   0.156617   0.234926 27.877839 10.884886 17.306186 6.499608
52 94.20889   0.103413   0.000000  2.585315 14.788004 22.130300 7.032058
95 45.07898   0.243013   0.729040  3.037667  9.599028  8.626974 3.037667
    P_18_24  P_25_34   P_35_44  P_45_54  P_55_64   P_65_74   P_75_UP
98 37.47495 30.06012 12.825651 7.615230 4.208417  2.605210  1.402806
93  0.00000  0.00000  0.000000 0.000000 0.000000  0.000000  0.000000
99 10.99744 22.63427 18.414322 7.161125 4.219949  4.731458  1.790281
83 13.31245 17.85435 13.547377 9.162099 5.481597  3.054033  2.897416
52 14.06412 16.95967  8.273009 7.549121 4.446743  3.516029  1.240951
95 12.39368 15.30984 11.664642 7.168894 8.140948 10.692588 13.365735
                    geometry
98 POINT (551423.1 172304.5)
93 POINT (555168.5 172163.4)
99 POINT (549133.6 169623.6)
83 POINT (558373.1 173223.7)
52 POINT (549729.3 177376.3)
95 POINT (546241.4 171265.2)</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="lecture4.html#cb5-1" tabindex="-1"></a><span class="fu">tm_shape</span>(blocks_sf2) <span class="sc">+</span></span>
<span id="cb5-2"><a href="lecture4.html#cb5-2" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="lecture4.html#cb5-3" tabindex="-1"></a>  <span class="fu">tm_shape</span>(br_bl_sf)<span class="sc">+</span></span>
<span id="cb5-4"><a href="lecture4.html#cb5-4" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="sec2" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Buffers and Features<a href="lecture4.html#sec2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="rmdnote">
<p><strong>What is a Buffer?</strong></p>
<p>A buffer in GIS is a reclassification based on distance: classification of within/without a given proximity. In other words, a buffer in GIS is a defined zone or area created around a geographic feature such as a point, line, or polygon.</p>
<p>The buffer is typically measured in units of distance, such as feet, meters, or kilometers, and represents a specific radius or width around the feature.</p>
</div>
<p>In many situations, we are interested in events or features that occur neat to our area of interest as well as those within it. We may be interested in crimes that occur within a certain distance of particular areas or locations. <strong>Buffering</strong> operations provide a convenient way of doing this, and buffers can be created using the <span class="math inline">\(st\_buffer()\)</span> function. In the New Haven data, there is a <span class="math inline">\(places\)</span> data frame that contains major landmarks in New Haven. We can create buffers around the major neighborhoods to define crimes that happen within a certain distance of the neighborhoods.</p>
<p>Setting distance on the buffer: In case dist is a units object, it should be convertible to arc_degree if x has geographic coordinates, and to st_crs(x)$units otherwise.EMILY TO CHECK THIS I THINK BELOW IS 1500m. Pertaining to change projections.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="lecture4.html#cb6-1" tabindex="-1"></a><span class="fu">data</span>(newhaven)</span>
<span id="cb6-2"><a href="lecture4.html#cb6-2" tabindex="-1"></a>breach_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(breach)</span>
<span id="cb6-3"><a href="lecture4.html#cb6-3" tabindex="-1"></a>places_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(places, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>), <span class="at">crs =</span> <span class="st">&quot;NAD83&quot;</span>)</span>
<span id="cb6-4"><a href="lecture4.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="lecture4.html#cb6-5" tabindex="-1"></a><span class="fu">st_crs</span>(places_sf) <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(breach_sf)</span>
<span id="cb6-6"><a href="lecture4.html#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="lecture4.html#cb6-7" tabindex="-1"></a><span class="co">#Create a polygon buffer around the places centroids. </span></span>
<span id="cb6-8"><a href="lecture4.html#cb6-8" tabindex="-1"></a>places_sf_buff <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(places_sf, <span class="at">dist =</span> <span class="dv">1500</span>)</span>
<span id="cb6-9"><a href="lecture4.html#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="lecture4.html#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="lecture4.html#cb6-11" tabindex="-1"></a><span class="fu">tm_shape</span>(blocks_sf) <span class="sc">+</span></span>
<span id="cb6-12"><a href="lecture4.html#cb6-12" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="lecture4.html#cb6-13" tabindex="-1"></a>  <span class="fu">tm_shape</span>(places_sf) <span class="sc">+</span></span>
<span id="cb6-14"><a href="lecture4.html#cb6-14" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb6-15"><a href="lecture4.html#cb6-15" tabindex="-1"></a>  <span class="fu">tm_shape</span>(places_sf_buff) <span class="sc">+</span></span>
<span id="cb6-16"><a href="lecture4.html#cb6-16" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb6-17"><a href="lecture4.html#cb6-17" tabindex="-1"></a>  <span class="fu">tm_shape</span>(breach_sf) <span class="sc">+</span></span>
<span id="cb6-18"><a href="lecture4.html#cb6-18" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Alternatively, if you want to subset data to only include those areas/points that are located within a certain distance of another spatial extent, we can use the<span class="math inline">\(st\_is\_within\_distance()\)</span> function. Below we want to identify the breaches that occur within 1500m of the neighborhood centroids. We use the above function to define the following: (1) The first input is the points we want to be the centroids, (2) The area/points that lay within a distance, and (3) The distance value.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="lecture4.html#cb7-1" tabindex="-1"></a>indices_within_dist <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">st_is_within_distance</span>(places_sf, breach_sf, <span class="at">dist =</span> <span class="dv">1500</span>))</span>
<span id="cb7-2"><a href="lecture4.html#cb7-2" tabindex="-1"></a>breach_within <span class="ot">&lt;-</span> breach_sf[indices_within_dist,]</span>
<span id="cb7-3"><a href="lecture4.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="lecture4.html#cb7-4" tabindex="-1"></a><span class="fu">tm_shape</span>(blocks_sf) <span class="sc">+</span></span>
<span id="cb7-5"><a href="lecture4.html#cb7-5" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="lecture4.html#cb7-6" tabindex="-1"></a>  <span class="fu">tm_shape</span>(places_sf) <span class="sc">+</span></span>
<span id="cb7-7"><a href="lecture4.html#cb7-7" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href="lecture4.html#cb7-8" tabindex="-1"></a>  <span class="fu">tm_shape</span>(places_sf_buff) <span class="sc">+</span></span>
<span id="cb7-9"><a href="lecture4.html#cb7-9" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="lecture4.html#cb7-10" tabindex="-1"></a>  <span class="fu">tm_shape</span>(breach_within) <span class="sc">+</span></span>
<span id="cb7-11"><a href="lecture4.html#cb7-11" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="sec3" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Merging Spatial Features<a href="lecture4.html#sec3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the intersection example, we selected census blocks within New Haven and used them to define the area of interest. Attributes for the selected census blocks were added to the point data for breaches. In other instances, we may wish to consider the area as a single object and merge all features within it. This can be done using the <span class="math inline">\(st\_combine()\)</span> function. As an exmaple, what is we wanted to derive the outline of the city of New Haven, we can merge all attributes from the census block data shown below.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="lecture4.html#cb8-1" tabindex="-1"></a>merge_blocks <span class="ot">&lt;-</span> <span class="fu">st_union</span>(blocks_sf)</span>
<span id="cb8-2"><a href="lecture4.html#cb8-2" tabindex="-1"></a>merge_blocks</span></code></pre></div>
<pre><code>## Geometry set for 1 feature 
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 531731.9 ymin: 147854 xmax: 569625.3 ymax: 188464.6
## Projected CRS: SOURCECRS</code></pre>
<pre><code>## POLYGON ((561858.8 152537.1, 561501.4 152099.8,...</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="lecture4.html#cb11-1" tabindex="-1"></a><span class="fu">tm_shape</span>(blocks_sf) <span class="sc">+</span></span>
<span id="cb11-2"><a href="lecture4.html#cb11-2" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="lecture4.html#cb11-3" tabindex="-1"></a>  <span class="fu">tm_shape</span>(merge_blocks) <span class="sc">+</span></span>
<span id="cb11-4"><a href="lecture4.html#cb11-4" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The union operations merge spatial object sub-geometries. Once the merged objects have been created they can be used as inputs into the intersection and buffering procedures in order to select data for analysis. The merged objects can also be used in a cartographic context to provide a border to the study area being considered.</p>
</div>
<div id="point-in-polygon-and-area-calculations" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Point-In-Polygon and Area Calculations<a href="lecture4.html#point-in-polygon-and-area-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="point-in-polygon" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Point-In-Polygon<a href="lecture4.html#point-in-polygon" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is often useful to count the number of points falling within different ones in a polygon datasets. This can be done using the <span class="math inline">\(poly.counts()\)</span> function in the <a href="http://cran.nexr.com/web/packages/GISTools/GISTools.pdf"><em>GISTools</em></a> package, which extends on the <span class="math inline">\(st\_contains()\)</span> function. The code below assigns a list of counts of the number of crimes that occur inside each census block using the <span class="math inline">\(st\_contain()\)</span> function. We use the <span class="math inline">\(lapply()\)</span> function to count the number crimes in each list element.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="lecture4.html#cb12-1" tabindex="-1"></a>crime.count <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">st_contains</span>(blocks_sf,breach_sf, <span class="at">sparse =</span> F))</span>
<span id="cb12-2"><a href="lecture4.html#cb12-2" tabindex="-1"></a>blocks_sf<span class="sc">$</span>crime.count <span class="ot">&lt;-</span> crime.count</span>
<span id="cb12-3"><a href="lecture4.html#cb12-3" tabindex="-1"></a>blocks_sf<span class="sc">$</span>crime.count[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code> [1] 2 0 2 0 2 0 0 0 3 0</code></pre>
<p>These number represent the number of breaches in each census block in each row of the <span class="math inline">\(blocks\_sf\)</span> data frame.</p>
</div>
<div id="area-calculations" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Area Calculations<a href="lecture4.html#area-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another useful operation is to be able to calculate polygon areas. The <span class="math inline">\(st\_area()\)</span> function computes the euclidean or great circle distance between pairs of geometries. The results below show the square footage of the first 4 census blocks. Perhaps not a super useful metric to use. We can convert the calculation to square mile using the <span class="math inline">\(ft2mile()\)</span> function, which converts to 2.8 sq. feet per sq. mile.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="lecture4.html#cb14-1" tabindex="-1"></a>areas_calc <span class="ot">&lt;-</span> <span class="fu">st_area</span>(blocks_sf)</span>
<span id="cb14-2"><a href="lecture4.html#cb14-2" tabindex="-1"></a>areas_calc[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb14-3"><a href="lecture4.html#cb14-3" tabindex="-1"></a><span class="fu">ft2miles</span>(areas_calc[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span></code></pre></div>
</div>
</div>
<div id="creating-distance-attributes" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Creating Distance Attributes<a href="lecture4.html#creating-distance-attributes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="rmdnote">
<p><strong>Why is distance important?</strong></p>
<p>Distance is fundamental to spatial analysis. Distance measures are used to evaluate differences in accessibility for different social groups.</p>
</div>
<p>We may wish to analyze the number of locations or people within certain distances of the spatial features. Distance is approximated using a series of buffers created at specific distance intervals around features. The most common function used is <em>dist()</em>. This calculates Euclidean distance between points.</p>
<p>Let’s calculate the distance between the centroids (midpoints) of New Haven census blocks and the green spaces locations (these could also represent other features, i.e., facility locations, clinics). The locations of green spaces in NH is saved in the <em>places</em> dataset.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="lecture4.html#cb15-1" tabindex="-1"></a><span class="co">#Extract the centroids (midpoints) of the New Haven census blocks. </span></span>
<span id="cb15-2"><a href="lecture4.html#cb15-2" tabindex="-1"></a>centroids <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(blocks_sf)</span>
<span id="cb15-3"><a href="lecture4.html#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="lecture4.html#cb15-4" tabindex="-1"></a><span class="co">#Calculate the distance between the census block midpoints and the place locations.</span></span>
<span id="cb15-5"><a href="lecture4.html#cb15-5" tabindex="-1"></a><span class="co">#notes the use of the ft2miles function to convert to miles</span></span>
<span id="cb15-6"><a href="lecture4.html#cb15-6" tabindex="-1"></a>cents_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(centroids)</span>
<span id="cb15-7"><a href="lecture4.html#cb15-7" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">ft2miles</span>(<span class="fu">st_distance</span>(cents_sf, places_sf))</span>
<span id="cb15-8"><a href="lecture4.html#cb15-8" tabindex="-1"></a>distances[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>Units: [US_survey_foot]
[1] 2.910784 2.666624 2.963935 2.924395 3.175274</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="lecture4.html#cb17-1" tabindex="-1"></a><span class="fu">tm_shape</span>(blocks_sf) <span class="sc">+</span></span>
<span id="cb17-2"><a href="lecture4.html#cb17-2" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">&quot;white&quot;</span>)<span class="sc">+</span></span>
<span id="cb17-3"><a href="lecture4.html#cb17-3" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="lecture4.html#cb17-4" tabindex="-1"></a><span class="fu">tm_shape</span>(cents_sf) <span class="sc">+</span></span>
<span id="cb17-5"><a href="lecture4.html#cb17-5" tabindex="-1"></a><span class="fu">tm_dots</span>(<span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="lecture4.html#cb17-6" tabindex="-1"></a>  <span class="fu">tm_shape</span>(places_sf) <span class="sc">+</span></span>
<span id="cb17-7"><a href="lecture4.html#cb17-7" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) </span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-10-1.png" width="672" />
What do we get?</p>
<ul>
<li>distances: A 129 by 9 matrix.</li>
<li>For each block midpoint, the distance (in miles) to the 9 different places.</li>
<li>Using this matrix, we can provide a measure of the average distance experienced by people living in that area (census block) to get to those places.</li>
</ul>
</div>
<div id="distanceaccessibility-analysis" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Distance/Accessibility Analysis<a href="lecture4.html#distanceaccessibility-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The use of distance measures in conjunction with census data is particularly useful for analyzing access to locations or facilities. We may want to examines access to green spaces or hospitals for different social groups. In our current example, we can examine the equity of access to local landmarks recorded in the <em>places</em> location data for different ethnic groups reported in the <em>blocks</em> dataset. We will use the census data to approximate the number of people with and without access of less than 1 mile.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="lecture4.html#cb18-1" tabindex="-1"></a><span class="co">#Create a vector that calculates the minimum distance to green space for each census block</span></span>
<span id="cb18-2"><a href="lecture4.html#cb18-2" tabindex="-1"></a><span class="co">#Use the apply function that does row or column wise calculations, i.e., instead of doing every row separately. </span></span>
<span id="cb18-3"><a href="lecture4.html#cb18-3" tabindex="-1"></a><span class="co">#?apply</span></span>
<span id="cb18-4"><a href="lecture4.html#cb18-4" tabindex="-1"></a>min.dist <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">apply</span>(distances, <span class="dv">1</span>, min))</span>
<span id="cb18-5"><a href="lecture4.html#cb18-5" tabindex="-1"></a><span class="co">#Create indicator if there is a green space location within 1 mile (T or F)</span></span>
<span id="cb18-6"><a href="lecture4.html#cb18-6" tabindex="-1"></a>blocks_sf<span class="sc">$</span>access <span class="ot">&lt;-</span> min.dist <span class="sc">&lt;</span> <span class="dv">1</span> <span class="co">#This statement says &quot;is the min distance less than 1, yes or no?&quot;</span></span>
<span id="cb18-7"><a href="lecture4.html#cb18-7" tabindex="-1"></a>blocks_sf<span class="sc">$</span>access[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE</code></pre>
<p>Let’s take a look at the data</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="lecture4.html#cb20-1" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb20-2"><a href="lecture4.html#cb20-2" tabindex="-1"></a><span class="co"># View(blocks_sf)</span></span>
<span id="cb20-3"><a href="lecture4.html#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="lecture4.html#cb20-4" tabindex="-1"></a><span class="fu">tm_shape</span>(blocks_sf) <span class="sc">+</span></span>
<span id="cb20-5"><a href="lecture4.html#cb20-5" tabindex="-1"></a><span class="fu">tm_polygons</span>(<span class="st">&quot;access&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="lecture4.html#cb20-6" tabindex="-1"></a>  <span class="fu">tm_shape</span>(places_sf) <span class="sc">+</span></span>
<span id="cb20-7"><a href="lecture4.html#cb20-7" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The populations of each ethnic group in each census block can be extracted from the <em>blocks</em> dataset:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="lecture4.html#cb21-1" tabindex="-1"></a><span class="co"># extract the ethnicity data from the blocks variable</span></span>
<span id="cb21-2"><a href="lecture4.html#cb21-2" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(blocks[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">14</span><span class="sc">:</span><span class="dv">18</span>]))</span></code></pre></div>
<pre><code>##     P_WHITE  P_BLACK P_AMERI_ES P_ASIAN_PI  P_OTHER
## 0  7.095159 87.02003   0.584307   0.041736 5.258765
## 1 87.105177 10.45262   0.195376   0.521003 1.725822
## 2 32.931727 66.26506   0.100402   0.200803 0.502008</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="lecture4.html#cb23-1" tabindex="-1"></a><span class="co">#Create a matrix of proportions of each ethnic group</span></span>
<span id="cb23-2"><a href="lecture4.html#cb23-2" tabindex="-1"></a>ethnicity <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">data.frame</span>(blocks[,<span class="dv">14</span><span class="sc">:</span><span class="dv">18</span>])<span class="sc">/</span><span class="dv">100</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb23-3"><a href="lecture4.html#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="lecture4.html#cb23-4" tabindex="-1"></a><span class="co"># Multiple proportion by the population to get the number within each group using colimn-wise apply() function.</span></span>
<span id="cb23-5"><a href="lecture4.html#cb23-5" tabindex="-1"></a>ethnicity <span class="ot">&lt;-</span> <span class="fu">apply</span>(ethnicity, <span class="dv">2</span>, <span class="cf">function</span>(x)(x <span class="sc">*</span> blocks_sf<span class="sc">$</span>POP1990))</span>
<span id="cb23-6"><a href="lecture4.html#cb23-6" tabindex="-1"></a></span>
<span id="cb23-7"><a href="lecture4.html#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="lecture4.html#cb23-8" tabindex="-1"></a><span class="co">#Create a matrix of counts by group</span></span>
<span id="cb23-9"><a href="lecture4.html#cb23-9" tabindex="-1"></a>ethnicity <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">as.integer</span>(ethnicity), <span class="at">ncol =</span> <span class="dv">5</span>))</span>
<span id="cb23-10"><a href="lecture4.html#cb23-10" tabindex="-1"></a><span class="fu">colnames</span>(ethnicity) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Black&quot;</span>,</span>
<span id="cb23-11"><a href="lecture4.html#cb23-11" tabindex="-1"></a><span class="st">&quot;Native American&quot;</span>, <span class="st">&quot;Asian&quot;</span>, <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb23-12"><a href="lecture4.html#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="lecture4.html#cb23-13" tabindex="-1"></a>ethnicity<span class="sc">$</span>access <span class="ot">&lt;-</span> blocks<span class="sc">$</span>access</span>
<span id="cb23-14"><a href="lecture4.html#cb23-14" tabindex="-1"></a></span>
<span id="cb23-15"><a href="lecture4.html#cb23-15" tabindex="-1"></a><span class="fu">head</span>(ethnicity)</span></code></pre></div>
<pre><code>##   White Black Native American Asian Other
## 1   170  2084              13     0   126
## 2  2674   320               5    16    52
## 3   328   659               1     1     4
## 4   153  1142               6     6    26
## 5   672   223               3    12     3
## 6  1156    97               9    11    41</code></pre>
<div class="rmdtip">
<p><strong>Lab 4 Activity</strong></p>
<ol style="list-style-type: decimal">
<li><p>Using your R Markdown file from Lab 3, read in your project data and convert it to an <span class="math inline">\(sf\)</span> data frame using the <span class="math inline">\(st\_as\_sf()\)</span> function as before.</p></li>
<li><p>Using your area (polygon) data, create a set of indices to subset (you can set your own indices or you can use the code below which selects 5 indices at random out of 50 indices).</p></li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="lecture4.html#cb25-1" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">replace =</span> F)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><p>Create a data frame that only includes the selected row indices.</p></li>
<li><p>Subset your point data to only include points in the selected areas.</p></li>
<li><p>Plot the subsetted point and area data using the <span class="math inline">\(tmap\)</span> functions.</p></li>
<li><p>Using the full point and area data, create a buffer of 1000 m surrounding each point and create a plot with the boundaries of the spatial polygons, the points, and the surrounding buffers.</p></li>
<li><p>Using the full point and area data, calculate the number of incidents that occur within each polygon using the <span class="math inline">\(st\_contains()\)</span> function.</p></li>
<li><p>Using the full point and area data, calculate the number of incidents that occurred within a 1000 m distance of the point data.</p></li>
</ol>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lecture3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-raster-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-BasicGIS.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
